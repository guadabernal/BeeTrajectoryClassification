# BeeTrajectoryClassification


Install Requirements:
- pip install ultralytics

!!Do not install ffmpeg!! It will have to be uninstalled. Instead, install the following:
- pip install ffmpeg-python 

## videoConvert.py
This file converts the .h264 compressed video format to a .avi format that can 
be processed by the rest of the code. 

Folder containing videoConver.py should contain sub-folder video_avi and video_raw.
In the video_raw folder place the .h264 files to be converted. If a .avi file 
with the same name already exists it will not re-convert it until it is removed.
To run the program faster, the number of processors available can be changed to 
produce a large speedup. 

## beeDetector.py
This file will iterate through all of the frames and detect the bees in each
by importing the yolov8 model and runninng inference on each frame. The output
of this script is a JSON file that contains the bounding boxes and confidence 
for each frame.

This file will only run inference on 1 file at a time. To select file, edit the 
variable 'video_path'. You should see the following output in terminal:

0%|‚ñè   ...   | frames/total frames [Time Elapsed < Total Time,  200it/s]

If GPU acceleration is turned on the it/s should be between ~100-200. 
This should amount to a total time between 15 - 30 minutes.  
This program is not feasible to run on CPU, that typically results in ~8-9 it/s
and would take > 15 hours to complete. 

## sequenceGenerator.py
This file will take the JSON file generated by the beeDetector.py and split the
frames into sequences. Then it will generate a second _seq JSON file. It will 
also output a summary of the sequences within each range of frames / sequence.
Only 1 file gets generated at a time, set the json_file_path parameter. 

Other parameters that can be editted are:
  sequence_gap_max     = 10
  min_sequence_len     = 10
  confidence_threshold = 50.0
  iou_threshold        =  0.1

